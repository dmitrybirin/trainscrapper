<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
    <title>TrainsScrapper</title>
</head>
<body>
    <header>
        <h2 class="md-display-2">Train Scrapper</h2>
        <h5 class="md-display-5">v.0.0.1</h5>
    </header>
    <p>Look at the browser console for now</p>
    <button style="color:red" onclick="lauchTaskForDays(1)">BIG RED BUTTON</button>
    
</body>
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io({reconnection: false})
  socket.on('connection', function (data) {
    console.log('connection!!!');
  });
  socket.on('debug', function (data) {
    console.log(data);
  });
  socket.on('info', function (data) {
    console.log(`::INFO:: ${data}`);
  });
  socket.on('error', function (data) {
    console.log(`::ERROR:: ${data}`);
  });
  var lauchTaskForDays = function(days) {
      document.querySelector('button').setAttribute('disabled','disabled')
      document.querySelector('button').style.color = 'grey'

      fetch(`/api/task/gatherDataFor/${days}`)
        .then(function(response) {
            response.json().then(function(data) {
                document.querySelector('button').removeAttribute('disabled')
                document.querySelector('button').style.color = 'red' 
                if (!data.error) {
                    console.log('--TASK RUN WAS SUCCESSFUL--')
                }
                else console.log('--TASK RUN WAS END WITH ERRORS--\n',data.error)
            });  
        })
        .catch(function(err) {  
            console.log('--FETCH ERROR--:', err)
        });;
  }

</script>
</html>